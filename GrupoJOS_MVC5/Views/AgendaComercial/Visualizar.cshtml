@{
    ViewBag.Title = "Visualização Agendamento Comercial";
    var adm = Request.Cookies["UsuarioADM"].Value;
    var date = DateTime.Now;
    var data = date.ToShortDateString();
}

@model GrupoJOS_MVC5.Models.ViewModelAgendaComercial

<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-10">
        <h2>@ViewBag.Title</h2>
        <ol class="breadcrumb">
            <li>
                <a href="@Url.Action("Index", "Home")">Home</a>
            </li>
            <li>
                <a>Agenda Comercial</a>
            </li>
            <li class="active">
                <strong>@ViewBag.Title</strong>
            </li>
        </ol>
    </div>
</div>

<div class="wrapper wrapper-content animated fadeInRight">

    <div class="col-md-12">
        <div class="ibox float-e-margins">
            <div class="ibox-content">
                <div class="row m-b-lg m-t-lg">
                    <div class="col-md-6">
                        <div class="profile-info">
                            <div class="">
                                <div>
                                    <h2 class="no-margins">
                                        @Model.clienteComercial.Nome
                                    </h2>
                                    <h4>Visualizando Agendamento</h4>
                                    <small>
                                        As informações abaixo são referentes ao seu agendamento para com esse Profissional de Saúde e detalhes sobre clínicas a apresentar e dados do cliente.
                                    </small>
                                    <div class="row">
                                        @if(Model.agenda.Status == "0")
                                        {
                                            <div class="col-md-6">
                                                <a href="/AgendaComercial/Editar/@Model.agenda.idagenda"><button type="button" class="btn btn-warning btn-sm btn-block"><i class="fa fa-edit"></i> Editar</button></a>
                                            </div>
                                        }
                                        
                                        @if (adm == "True")
                                        {
                                            if (Model.agenda.Status == "1")
                                            {
                                                <div class="col-md-6">
                                                    <a href="/AgendaComercial/EditarVisita/@Model.agenda.idagenda"><button type="button" class="btn btn-warning btn-sm btn-block"><i class="fa fa-edit"></i> Editar Visita</button></a>
                                                </div>
                                            }
                                        <div class="col-md-6">
                                            <button type="button" class="btn btn-danger btn-sm btn-block" data-type="confirm" onclick="AssignButtonClicked(this)" data-assigned-id="@Model.agenda.idagenda"><i class="fa fa-times"></i> Remover</button>
                                        </div>
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <small>Ramo</small>
                        <table class="table small m-b-xs">
                            <tbody>
                                @if (Model.clienteComercial.Ramo != 0 )
	                            {
                                    <tr>
                                        <td>
                                            <h2><strong>@Model.clienteComercial.RamoNome </strong ></h2>
                                        </td>
                                    </tr>  
	                            }


                            </tbody>
                        </table>
                    </div>
                    <div class="col-md-3">
                        <small>Ultima Visita</small>
                        @if (!String.IsNullOrEmpty(Model.clienteComercial.UltimaVisita))
                            {<h2 class="no-margins">@Model.clienteComercial.UltimaVisita.Substring(0, 10)</h2>}
                        else{<h2>Não Visitado</h2>}

                    </div>
                </div>
            </div>
        </div>
    </div>



    <div class="row">
        <div class="col-lg-6 m-b-lg">
            <div id="vertical-timeline" class="vertical-container light-timeline no-margins">
                <div class="vertical-timeline-block">
                    <div class="vertical-timeline-icon navy-bg">
                        <i class="fa fa-clock-o"></i>
                    </div>

                    <div class="vertical-timeline-content">
                        <h2>Dados do Agendamento</h2>
                        <div class="full-height-scroll">
                            <ul class="list-group clear-list">
                                <li class="list-group-item fist-item">
                                    <span class="pull-right"> @Model.agenda.DataVisita.Substring(0, 10) - @Model.agenda.HoraVisita </span>
                                    Visita
                                </li>
                                <li class="list-group-item">
                                    <span class="pull-right">  @Model.clienteComercial.Fone1 </span>
                                    Telefone 1:
                                </li>
                                <li class="list-group-item">
                                    <span class="pull-right">  @Model.clienteComercial.Fone2 </span>
                                    Telefone 2:
                                </li>
                                <li class="list-group-item">
                                    <span class="pull-right"> @Model.clienteComercial.Email </span>
                                    Email
                                </li>
                                @if(Model.clienteComercial.Conveniado == 1)
                                {
                                <li class="list-group-item">
                                    Conveniado
                                </li>
                                }
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            @if(Model.agenda.Status == "1")
            {
                <div id="vertical-timeline" class="vertical-container light-timeline no-margins">
                    <div class="vertical-timeline-block">
                        <div class="vertical-timeline-icon navy-bg">
                            <i class="fa fa-check"></i>
                        </div>

                        <div class="vertical-timeline-content">
                            <h2>Visita Finalizada</h2>
                            <div class="full-height-scroll">
                                <ul class="list-group clear-list">
                                    <li class="list-group-item fist-item">
                                        <span class="pull-right"> @Model.agenda.DataFinalizada</span>
                                        Finalizada em
                                    </li>
                                    <li class="list-group-item">
                                        <span class="pull-right">  @Model.agenda.DataFinalizadaReal </span>
                                        Finalizada realmente em:
                                    </li>
                                </ul>
                                <strong>Observações</strong>
                                <p>
                                    @Model.agenda.Observacoes
                                </p>
                            </div>
                        </div>

                    </div>
                </div>
            }
        </div>

        <div class="col-lg-6 m-b-lg">
            <div id="vertical-timeline" class="vertical-container light-timeline no-margins">
                <div class="vertical-timeline-block">
                    <div class="vertical-timeline-icon lazur-bg">
                        <i class="fa fa-briefcase"></i>
                    </div>
                    <div class="vertical-timeline-content">
                        <h2>Dados do Cliente</h2>
                        <div class="full-height-scroll">
                            <ul class="list-group clear-list">
                                <li class="list-group-item fist-item">
                                    <span class="pull-right">  @Model.clienteComercial.Endereco </span>
                                    Endereço
                                </li>
                                <li class="list-group-item">
                                    <span class="pull-right"> @Model.clienteComercial.Bairro </span>
                                    Bairro
                                </li>
                                <li class="list-group-item">
                                    <span class="pull-right">  @Model.clienteComercial.Cidade </span>
                                    Cidade
                                </li>
                                <li class="list-group-item">
                                    <span class="pull-right"> @Model.clienteComercial.UF </span>
                                    Estado
                                </li>
                                <li class="list-group-item">
                                    <span class="pull-right">  @Model.clienteComercial.Fone1 </span>
                                    Telefone 1
                                </li>
                                <li class="list-group-item">
                                    <span class="pull-right"> @Model.clienteComercial.Fone2 </span>
                                    Telefone 2
                                </li>
                                <li class="list-group-item">
                                    <span class="pull-right">  @Model.clienteComercial.Contato </span>
                                    Contato
                                </li>
                                <li class="list-group-item">
                                    <span class="pull-right">  @Model.clienteComercial.DataCadastro </span>
                                    Data Cadastro
                                </li>

                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            function AssignButtonClicked(elem) {
                var id = $(elem).data('assigned-id');
                swal({
                    title: "Tem certeza?",
                    text: "Esse registro sera apagado e nao podera ser recuperado!",
                    icon: "warning",
                    buttons: { cancel: "Cancelar", ok: "Sim, pode remover!" },
                    dangerMode: true,
                })
                    .then((willDelete) => {
                        if (willDelete) {
                            swal("Removido!", "Registro foi removido com sucesso!", "success")
                                .then((value) => {
                                    $.post("/AgendaComercial/Index/" + id + "");
                                    window.location = "/AgendaComercial/Index";
                                });
                        } else {
                            swal("Cancelado!", "O registro não foi removido", "error");
                        }
                    });
            }
        </script>

    </div>

</div>

@section Scripts {
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
}
