@{
    ViewBag.Title = "Edição de Empresas";
}

@model GrupoJOS_MVC5.Models.Model_Empresa

<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-10">
        <h2>@ViewBag.Title</h2>
        <ol class="breadcrumb">
            <li>
                <a href="@Url.Action("Index", "Home")">Home</a>
            </li>
            <li>
                <a>Empresas</a>
            </li>
            <li class="active">
                <strong>@ViewBag.Title</strong>
            </li>
        </ol>
    </div>
</div>
<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row">
        <div class="col-lg-12">
            <div class="ibox float-e-margins">
                <div class="ibox-content">
                    <div class="row">
                        <div class="col-sm-12 b-r">
                            @using (Html.BeginForm())
                            {
                                @Html.AntiForgeryToken()

                                @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                                @Html.HiddenFor(model => model.idempresa)
                                @Html.HiddenFor(model => model.Ativo)
                                <form>
                                    <div class="row">
                                        <div class="col-md-12">
                                            <label for="nome">Nome</label>
                                            <div class="input-group">
                                                <span class="input-group-addon">
                                                    <i class="material-icons">star_border</i>
                                                </span>
                                                <div class="form-line">
                                                    @Html.EditorFor(model => model.Nome, new { htmlAttributes = new { @class = "form-control", placeholder = "Digite o nome da empresa" } })
                                                </div>
                                            </div>
                                            @Html.ValidationMessageFor(model => model.Nome, "", new { @class = "text-danger" })
                                        </div>
                                    </div>
                                    <br>
                                    <div class="row">
                                        <div class="col-md-4">
                                            <label for="razao">Razão Social</label>
                                            <div class="input-group">
                                                <span class="input-group-addon">
                                                    <i class="material-icons">chevron_right</i>
                                                </span>
                                                <div class="form-line">
                                                    @Html.EditorFor(model => model.RazaoSocial, new { htmlAttributes = new { @class = "form-control", placeholder = "Razão Social" } })
                                                </div>
                                            </div>
                                            @Html.ValidationMessageFor(model => model.RazaoSocial, "", new { @class = "text-danger" })
                                        </div>
                                        <div class="col-md-4">
                                            <label for="cnpj">CNPJ</label>
                                            <div class="input-group">
                                                <span class="input-group-addon">
                                                    <i class="material-icons">chevron_right</i>
                                                </span>
                                                <div class="form-line">
                                                    @Html.EditorFor(model => model.CNPJ, new { htmlAttributes = new { @class = "form-control", placeholder = "Ex:00.000.000/0001-12" } })
                                                </div>
                                            </div>
                                            @Html.ValidationMessageFor(model => model.CNPJ, "", new { @class = "text-danger" })
                                        </div>
                                        <div class="col-md-4">
                                            <label for="insc-est">Inscrição Estadual</label>
                                            <div class="input-group">
                                                <span class="input-group-addon">
                                                    <i class="material-icons">chevron_right</i>
                                                </span>
                                                <div class="form-line">
                                                    @Html.EditorFor(model => model.InscricaoEstadual, new { htmlAttributes = new { @class = "form-control", placeholder = "Ex:000.000.000.000" } })
                                                </div>
                                            </div>
                                            @Html.ValidationMessageFor(model => model.InscricaoEstadual, "", new { @class = "text-danger" })
                                        </div>
                                    </div>
                                    <br>

                                    <div class="row">
                                        <div class="col-md-4">
                                            <label for="endereco">Endereço</label>
                                            <div class="input-group">
                                                <span class="input-group-addon">
                                                    <i class="material-icons">place</i>
                                                </span>
                                                <div class="form-line">
                                                    @Html.EditorFor(model => model.Endereco, new { htmlAttributes = new { @class = "form-control", placeholder = "Endereço" } })
                                                </div>
                                            </div>
                                            @Html.ValidationMessageFor(model => model.Endereco, "", new { @class = "text-danger" })
                                        </div>
                                        <div class="col-md-4">
                                            <label for="numero">Número</label>
                                            <div class="input-group">
                                                <span class="input-group-addon">
                                                    <i class="material-icons">my_location</i>
                                                </span>
                                                <div class="form-line">
                                                    @Html.EditorFor(model => model.Num, new { htmlAttributes = new { @class = "form-control", placeholder = "Nº" } })
                                                </div>
                                            </div>
                                            @Html.ValidationMessageFor(model => model.Num, "", new { @class = "text-danger" })
                                        </div>
                                        <div class="col-md-4">
                                            <label for="cep">CEP</label>
                                            <div class="input-group">
                                                <span class="input-group-addon">
                                                    <i class="material-icons">my_location</i>
                                                </span>
                                                <div class="form-line">
                                                    @Html.EditorFor(model => model.CEP, new { htmlAttributes = new { @class = "form-control", placeholder = "CEP" } })
                                                </div>
                                            </div>
                                            @Html.ValidationMessageFor(model => model.CEP, "", new { @class = "text-danger" })
                                        </div>
                                    </div>
                                    <br>

                                    <div class="row">
                                        <div class="col-md-4">
                                            <label for="bairro">Bairro</label>
                                            <div class="input-group">
                                                <span class="input-group-addon">
                                                    <i class="material-icons">map</i>
                                                </span>
                                                <div class="form-line">
                                                    @Html.EditorFor(model => model.Bairro, new { htmlAttributes = new { @class = "form-control", placeholder = "Bairro" } })
                                                </div>
                                            </div>
                                            @Html.ValidationMessageFor(model => model.Bairro, "", new { @class = "text-danger" })
                                        </div>
                                        <div class="col-md-4">
                                            <label for="cidade">Cidade</label>
                                            <div class="input-group">
                                                <span class="input-group-addon">
                                                    <i class="material-icons">location_city</i>
                                                </span>
                                                <div class="form-line">
                                                    @Html.EditorFor(model => model.Cidade, new { htmlAttributes = new { @class = "form-control", placeholder = "Cidade" } })
                                                </div>
                                            </div>
                                            @Html.ValidationMessageFor(model => model.Cidade, "", new { @class = "text-danger" })
                                        </div>
                                        <div class="col-md-4">
                                            <label for="estado">Estado</label>
                                            <div class="input-group">
                                                <span class="input-group-addon">
                                                    <i class="material-icons">pin_drop</i>
                                                </span>
                                                <div class="form-line">
                                                    @Html.EditorFor(model => model.UF, new { htmlAttributes = new { @class = "form-control", placeholder = "UF" } })
                                                </div>
                                            </div>
                                            @Html.ValidationMessageFor(model => model.UF, "", new { @class = "text-danger" })
                                        </div>
                                    </div>
                                    <br>

                                    <div class="row">
                                        <div class="col-md-3">
                                            <label for="contato">Contato (Secretaria)</label>
                                            <div class="input-group">
                                                <span class="input-group-addon">
                                                    <i class="material-icons">perm_identity</i>
                                                </span>
                                                <div class="form-line">
                                                    @Html.EditorFor(model => model.Contato, new { htmlAttributes = new { @class = "form-control", placeholder = "Nome do contato" } })
                                                </div>
                                            </div>
                                            @Html.ValidationMessageFor(model => model.Contato, "", new { @class = "text-danger" })
                                        </div>
                                        <div class="col-md-3">
                                            <label for="email_address">E-mail</label>
                                            <div class="input-group">
                                                <span class="input-group-addon">
                                                    <i class="material-icons">mail_outline</i>
                                                </span>
                                                <div class="form-line">
                                                    @Html.EditorFor(model => model.Email, new { htmlAttributes = new { @class = "form-control", placeholder = "Digite o e-mail" } })
                                                </div>
                                            </div>
                                            @Html.ValidationMessageFor(model => model.Email, "", new { @class = "text-danger" })
                                        </div>
                                        <div class="col-md-3">
                                            <label for="telefone1">Telefone 1</label>
                                            <div class="input-group">
                                                <span class="input-group-addon">
                                                    <i class="material-icons">phone</i>
                                                </span>
                                                <div class="form-line">
                                                    @Html.EditorFor(model => model.Fone1, new { htmlAttributes = new { @class = "form-control", placeholder = "Ex:(00) 0000-0000" } })
                                                </div>
                                            </div>
                                            @Html.ValidationMessageFor(model => model.Fone1, "", new { @class = "text-danger" })
                                        </div>
                                        <div class="col-md-3">
                                            <label for="telefone2">Telefone 2</label>
                                            <div class="input-group">
                                                <span class="input-group-addon">
                                                    <i class="material-icons">phone</i>
                                                </span>
                                                <div class="form-line">
                                                    @Html.EditorFor(model => model.Fone2, new { htmlAttributes = new { @class = "form-control", placeholder = "Ex:(00) 0000-0000" } })
                                                </div>
                                            </div>
                                            @Html.ValidationMessageFor(model => model.Fone2, "", new { @class = "text-danger" })
                                        </div>
                                    </div>
                                    <br>
                                    <br>

                                    <div class="row">
                                        <div class="col-md-6">
                                            @if (Model.Ativo)
                                            {
                                                <label> <input type="checkbox" class="i-checks" name="AtivaConta" checked> Ativa </label>
                                            }
                                            else
                                            {
                                                <label> <input type="checkbox" class="i-checks" name="AtivaConta"> Ativa </label>
                                            }
                                        </div>



                                        <div class="col-md-6">
                                            @if (!Model.Ativo)
                                            {
                                                <font color="red"> Empresa Cancelada em: @Model.DataCancelado </font>
                                            }
                                            else
                                            {
                                                <font color="green"> Empresa Ativada em: @Model.DataAtivado </font>
                                            }
                                        </div>
                                    </div>
                                    <br>

                                    <button type="submit" class="btn btn-primary m-t-15 waves-effect">SALVAR</button>
                                    <button type="button" onclick="window.history.back()" class="btn btn-danger m-t-15 waves-effect">CANCELAR</button>
                                </form>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@if (Model.ListaUsuario.Count > 0)
{
    <div class="wrapper wrapper-content animated fadeInRight">
        <div class="row">
            <div class="col-lg-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>Usuários </h5>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 b-r">

                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Usuário</th>
                                        <th>E-mail</th>
                                        <th>Último Acesso</th>
                                        <th>Perfil</th>
                                        <th>Opções</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach(var item in Model.ListaUsuario)
                                    {
                                        <tr>
                                            <td>@item.Nome</td>
                                            <td>@item.Email</td>
                                            <td>@item.UltimoAcesso</td>

                                            <td width="3%" align="center">
                                                @if(item.Perfil == "0")
                                                    {<i title="Propagandista" class="fa fa-map-marker"></i> <p>Propagandista</p>}
                                                @if(item.Perfil == "1")
                                                    {<i title="Comercial" class="fa fa-usd"></i> <p>Comercial</p>}
                                                @if(item.Perfil == "2")
                                                    {<i title="Personalizado" class="fa fa-asterisk"></i> <p>Personalizado</p>}
                                                @if(item.Perfil == "3")
                                                    {<i title="Empresa" class="fa fa-building"></i> <p>Empresa</p> <p>@item.NomeEmpresa</p>}
                                            </td>

                                            <td>
                                                <div class="js-sweetalert">
                                                    <a href="/Usuarios/Editar/@item.idusuario"><button class="btn btn-success dim" type="button"><i class="fa fa-edit"></i></button></a>
                                                    <button class="btn btn-danger dim" type="button" data-type="confirm" onclick="AssignButtonClicked(this)" data-assigned-id="@item.idusuario"><i class="fa fa-trash"></i></button>
                                                </div>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>

                         <script>
                            function AssignButtonClicked(elem) {
                                var id = $(elem).data('assigned-id');
                                swal({
									    title: "Tem certeza?",
                                        text: "Esse registro sera apagado e nao podera ser recuperado!",
                                        icon: "warning",
                                        buttons: {cancel: "Cancelar", ok: "Sim, pode remover!"},
                                        dangerMode: true,
                                    })
                                    .then((willDelete) => {
                                        if (willDelete) {
                                        swal("Removido!","Registro foi removido com sucesso!","success")
                                        .then((value) => {
                                            $.post("/Usuarios/Index/" + id + "");
                                            window.location ="/Empresas/Index";
                                        });
                                        } else {
                                        swal("Cancelado!","O registro não foi removido","error");
                                        }
                                    });
                            }
                    </script>

                    </div>
                </div>
            </div>
        </div>
    </div>
}


@section Styles {
    @Styles.Render("~/Content/plugins/iCheck/iCheckStyles")
}

@section Scripts {
    @Scripts.Render("~/plugins/iCheck")
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {

            $('.i-checks').iCheck({
                checkboxClass: 'icheckbox_square-green',
                radioClass: 'iradio_square-green',
            });

        });
    </script>

    <script src="~/Content/especificos/jquery.maskedinput.min.js" type="text/javascript"></script>

    <script type="text/javascript">

        $(function () {
            $.mask.definitions['~'] = "[+-]";
            $("#date").mask("99/99/9999");
            $("#CEP").mask("99999999");
            $("#Fone_Celular").mask("(99) 99999-9999");
            $("#Fone1").mask("(99) 9999-9999");
            $("#Fone2").mask("(99) 9999-9999");
            $("#Horario_In").mask("99:99");
            $("#Horario_Out").mask("99:99");
            $("#UF").mask("aa");
            $("#Aniversario_m").mask("99/99/9999");
            $("#Aniversario_c").mask("99/99/9999");
        });

    </script>
}